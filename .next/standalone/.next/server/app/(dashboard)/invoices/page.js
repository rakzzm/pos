(()=>{var e={};e.id=8743,e.ids=[8743],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},8086:e=>{"use strict";e.exports=require("module")},33873:e=>{"use strict";e.exports=require("path")},79551:e=>{"use strict";e.exports=require("url")},24154:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var a=s(70260),r=s(28203),i=s(25155),n=s.n(i),l=s(67292),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["(dashboard)",{children:["invoices",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,31140)),"/Users/rakzzm/Documents/Applications/Advakkad POS Application/src/app/(dashboard)/invoices/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,58426)),"/Users/rakzzm/Documents/Applications/Advakkad POS Application/src/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,71354)),"/Users/rakzzm/Documents/Applications/Advakkad POS Application/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,78162))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/rakzzm/Documents/Applications/Advakkad POS Application/src/app/(dashboard)/invoices/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/(dashboard)/invoices/page",pathname:"/invoices",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},30807:(e,t,s)=>{Promise.resolve().then(s.bind(s,31140))},83951:(e,t,s)=>{Promise.resolve().then(s.bind(s,65639))},45723:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(73258).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},19473:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(73258).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},21956:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(73258).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},33680:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(73258).A)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},27998:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(73258).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},10681:(e,t,s)=>{"use strict";var a=s(58009),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=a.useState,n=a.useEffect,l=a.useLayoutEffect,o=a.useDebugValue;function d(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!r(e,s)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),a=i({inst:{value:s,getSnapshot:t}}),r=a[0].inst,c=a[1];return l(function(){r.value=s,r.getSnapshot=t,d(r)&&c({inst:r})},[e,s,t]),n(function(){return d(r)&&c({inst:r}),e(function(){d(r)&&c({inst:r})})},[e]),o(s),s};t.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:c},23058:(e,t,s)=>{"use strict";var a=s(58009),r=s(94924),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=r.useSyncExternalStore,l=a.useRef,o=a.useEffect,d=a.useMemo,c=a.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,s,a,r){var u=l(null);if(null===u.current){var x={hasValue:!1,value:null};u.current=x}else x=u.current;var m=n(e,(u=d(function(){function e(e){if(!o){if(o=!0,n=e,e=a(e),void 0!==r&&x.hasValue){var t=x.value;if(r(t,e))return l=t}return l=e}if(t=l,i(n,e))return t;var s=a(e);return void 0!==r&&r(t,s)?(n=e,t):(n=e,l=s)}var n,l,o=!1,d=void 0===s?null:s;return[function(){return e(t())},null===d?void 0:function(){return e(d())}]},[t,s,a,r]))[0],u[1]);return o(function(){x.hasValue=!0,x.value=m},[m]),c(m),m}},94924:(e,t,s)=>{"use strict";e.exports=s(10681)},73450:(e,t,s)=>{"use strict";e.exports=s(23058)},65639:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>P});var a=s(45512),r=s(58009),i=s(13522),n=s(4643),l=s(27998),o=s(61075),d=s(15607),c=s(16873),u=s(18741),x=s(21956),m=s(19473),p=s(44269),h=s(87798),g=s(45723),f=s(49656),v=s(33680),y=s(80159),b=s(41561),j=s(12366),w=s.n(j);let N={id:"default",name:"Modern Restaurant",layout:"modern",primaryColor:"#3B82F6",secondaryColor:"#1E40AF",headerText:"Restaurant Invoice",footerText:"Thank you for dining with us!",showQRCode:!0,showDigitalSignature:!0},S=(0,y.vt)((e,t)=>({invoices:[],templates:[N],currentTemplate:N,loading:!1,error:null,fetchInvoices:async()=>{e({loading:!0,error:null});try{let t=await fetch("/api/invoices");if(!t.ok)throw Error("Failed to fetch invoices");let s=(await t.json()).map(e=>({...e,issueDate:new Date(e.issueDate).toISOString().split("T")[0],dueDate:new Date(e.dueDate).toISOString().split("T")[0],customerEmail:e.customerEmail||"",customerPhone:e.customerPhone||"",customerAddress:e.customerAddress||"",subtotal:e.items.reduce((e,t)=>e+t.unitPrice*t.quantity,0),totalDiscount:0,totalTax:0,notes:e.notes||"",terms:e.terms||"",items:e.items.map(e=>({...e,taxRate:6,discount:0}))}));e({invoices:s})}catch(t){e({error:t.message})}finally{e({loading:!1})}},createInvoice:async s=>{e({loading:!0,error:null});try{let e=`INV-${new Date().getFullYear()}-${String(t().invoices.length+1).padStart(3,"0")}`;if(!(await fetch("/api/invoices",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,invoiceNumber:e})})).ok)throw Error("Failed to create invoice");await t().fetchInvoices()}catch(t){throw e({error:t.message}),t}finally{e({loading:!1})}},updateInvoice:async(s,a)=>{e({loading:!0,error:null});try{if(!(await fetch(`/api/invoices/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw Error("Failed to update invoice");await t().fetchInvoices()}catch(t){throw e({error:t.message}),t}finally{e({loading:!1})}},deleteInvoice:async t=>{e({loading:!0,error:null});try{if(!(await fetch(`/api/invoices/${t}`,{method:"DELETE"})).ok)throw Error("Failed to delete invoice");e(e=>({invoices:e.invoices.filter(e=>e.id!==t)}))}catch(t){throw e({error:t.message}),t}finally{e({loading:!1})}},sendInvoice:async e=>{await t().updateInvoice(e,{status:"sent"})},markAsPaid:async(e,s)=>{await t().updateInvoice(e,{status:"paid",paymentMethod:s})},duplicateInvoice:async e=>{let s=t().invoices.find(t=>t.id===e);if(s){let{id:e,invoiceNumber:a,createdAt:r,updatedAt:i,...n}=s;await t().createInvoice({...n,status:"draft",issueDate:new Date().toISOString().split("T")[0],dueDate:new Date(Date.now()+2592e6).toISOString().split("T")[0]})}},generatePDF:async e=>{let s=t().currentTemplate,a=new b.default,r=s.primaryColor;a.setFillColor(r),a.rect(0,0,210,40,"F"),a.setTextColor(255,255,255),a.setFontSize(24),a.text(s.headerText,20,25),a.setTextColor(0,0,0),a.setFontSize(12),a.text(`Invoice #: ${e.invoiceNumber}`,20,55),a.text(`Issue Date: ${e.issueDate}`,20,65),a.text(`Due Date: ${e.dueDate}`,20,75),a.text(`Status: ${e.status.toUpperCase()}`,20,85),a.setFontSize(14),a.text("Bill To:",120,55),a.setFontSize(12),a.text(e.customerName,120,65),a.text(e.customerEmail,120,75),a.text(e.customerPhone,120,85);let i=e.items.map(e=>[e.description,e.quantity.toString(),`RM ${e.unitPrice.toFixed(2)}`,`${e.taxRate}%`,`RM ${e.discount.toFixed(2)}`,`RM ${e.total.toFixed(2)}`]);w()(a,{startY:100,head:[["Description","Qty","Unit Price","Tax","Discount","Total"]],body:i,theme:"grid",styles:{fillColor:[59,130,246],textColor:[255,255,255],fontSize:10},alternateRowStyles:{fillColor:[240,248,255]}});let n=a.lastAutoTable.finalY+20;a.text(`Subtotal: RM ${e.subtotal.toFixed(2)}`,120,n),a.text(`Discount: RM ${e.totalDiscount.toFixed(2)}`,120,n+10),a.text(`Tax: RM ${e.totalTax.toFixed(2)}`,120,n+20),a.setFontSize(14),a.text(`Grand Total: RM ${e.grandTotal.toFixed(2)}`,120,n+35),s.showQRCode&&a.text("QR Code: Payment Link",20,n+50),s.showDigitalSignature&&a.text("Digitally Signed",20,n+60),a.text(s.footerText,20,n+70),a.save(`${e.invoiceNumber}.pdf`)},generateBulkPDF:async e=>{for(let s of t().invoices.filter(t=>e.includes(t.id)))await t().generatePDF(s)},updateTemplate:t=>{e({currentTemplate:t})},getInvoiceStats:()=>{let e=t().invoices,s=e.length,a=e.filter(e=>"paid"===e.status).length,r=e.filter(e=>"sent"===e.status).length,i=e.filter(e=>{let t=new Date(e.dueDate);return"sent"===e.status&&t<new Date}).length,n=e.filter(e=>"paid"===e.status).reduce((e,t)=>e+t.grandTotal,0);return{total:s,paid:a,pending:r,overdue:i,totalRevenue:n,averageAmount:s>0?n/s:0}}}));var D=s(54810),k=s(20429);function A({isOpen:e,onClose:t}){let{createInvoice:s}=S(),{members:i,fetchMembers:n}=(0,D.b)(),{products:l,fetchProducts:o}=(0,k.K)(),[d,c]=(0,r.useState)(!1),[x,m]=(0,r.useState)([]),[y,b]=(0,r.useState)({customerId:"",customerName:"",customerEmail:"",customerPhone:"",customerAddress:"",status:"draft",issueDate:new Date().toISOString().split("T")[0],dueDate:new Date(Date.now()+2592e6).toISOString().split("T")[0],paymentMethod:"cash",notes:"",terms:"Payment due within 30 days."}),j=e=>{m(x.filter(t=>t.id!==e))},w=(e,t,s)=>{m(x.map(a=>{if(a.id===e){let e={...a,[t]:s};if("description"===t){let t=l.find(e=>e.name===s);t&&(e.unitPrice=t.price)}let r=e.quantity*e.unitPrice,i=e.discount,n=(r-i)*(e.taxRate/100);return e.total=r-i+n,e}return a}))},N=(e,t)=>{let s=l.find(e=>e.id===t);s&&m(x.map(t=>{if(t.id===e){let e=s.price,a=t.quantity||1,r=t.discount||0,i=t.taxRate||0,n=a*e;return{...t,description:s.name,unitPrice:e,quantity:a,taxRate:i,discount:r,total:n-r+i/100*(n-r)}}return t}))},A=x.reduce((e,t)=>e+t.quantity*t.unitPrice,0),C=x.reduce((e,t)=>e+t.discount,0),P=x.reduce((e,t)=>e+(t.quantity*t.unitPrice-t.discount)*(t.taxRate/100),0),T=A-C+P,F=async e=>{e.preventDefault(),c(!0);try{await s({...y,items:x,subtotal:A,totalDiscount:C,totalTax:P,grandTotal:T}),t()}catch(e){console.error("Failed to create invoice:",e),alert("Failed to create invoice. Please try again.")}finally{c(!1)}};return e?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 overflow-y-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-5xl max-h-[90vh] overflow-y-auto shadow-2xl flex flex-col",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center sticky top-0 bg-white z-10",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"New Invoice"}),(0,a.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(p.A,{className:"w-5 h-5 text-gray-500"})})]}),(0,a.jsxs)("form",{onSubmit:F,className:"p-6 space-y-8 flex-1",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-gray-50 rounded-xl border border-gray-100",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-gray-500 flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"w-4 h-4"})," Customer Details"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Select Customer"}),(0,a.jsxs)("select",{className:"w-full p-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 text-sm",onChange:e=>{let t=e.target.value;if("manual"===t){b(e=>({...e,customerId:"",customerName:"",customerEmail:"",customerPhone:"",customerAddress:""}));return}let s=i.find(e=>e.id===t);s&&b(e=>({...e,customerId:s.id,customerName:s.name,customerEmail:s.email,customerPhone:s.phone,customerAddress:""}))},value:y.customerId||"manual",children:[(0,a.jsx)("option",{value:"manual",children:"Manual Entry"}),i.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.phone,")"]},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Customer Name"}),(0,a.jsx)("input",{required:!0,type:"text",className:"w-full p-2 border border-gray-200 rounded-lg text-sm",value:y.customerName,onChange:e=>b({...y,customerName:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",className:"w-full p-2 border border-gray-200 rounded-lg text-sm",value:y.customerEmail,onChange:e=>b({...y,customerEmail:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-gray-500 flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"w-4 h-4"})," Invoice Details"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Issue Date"}),(0,a.jsx)("input",{type:"date",required:!0,className:"w-full p-2 border border-gray-200 rounded-lg text-sm",value:y.issueDate,onChange:e=>b({...y,issueDate:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Due Date"}),(0,a.jsx)("input",{type:"date",required:!0,className:"w-full p-2 border border-gray-200 rounded-lg text-sm",value:y.dueDate,onChange:e=>b({...y,dueDate:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Status"}),(0,a.jsxs)("select",{className:"w-full p-2 border border-gray-200 rounded-lg text-sm",value:y.status,onChange:e=>b({...y,status:e.target.value}),children:[(0,a.jsx)("option",{value:"draft",children:"Draft"}),(0,a.jsx)("option",{value:"sent",children:"Sent"}),(0,a.jsx)("option",{value:"paid",children:"Paid"}),(0,a.jsx)("option",{value:"overdue",children:"Overdue"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Payment Method"}),(0,a.jsxs)("select",{className:"w-full p-2 border border-gray-200 rounded-lg text-sm",value:y.paymentMethod,onChange:e=>b({...y,paymentMethod:e.target.value}),children:[(0,a.jsx)("option",{value:"cash",children:"Cash"}),(0,a.jsx)("option",{value:"card",children:"Card"}),(0,a.jsx)("option",{value:"bank_transfer",children:"Bank Transfer"}),(0,a.jsx)("option",{value:"digital_wallet",children:"Digital Wallet"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-600",children:"Line Items"}),(0,a.jsxs)("button",{type:"button",onClick:()=>{m([...x,{id:Math.random().toString(36).substr(2,9),description:"",quantity:1,unitPrice:0,taxRate:0,discount:0,total:0}])},className:"text-indigo-600 hover:text-indigo-700 text-sm font-medium flex items-center gap-1",children:[(0,a.jsx)(u.A,{className:"w-4 h-4"})," Add Item"]})]}),(0,a.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:(0,a.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,a.jsx)("thead",{className:"bg-gray-50 text-gray-500 font-medium border-b border-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-3 w-1/3",children:"Item / Description"}),(0,a.jsx)("th",{className:"p-3 w-20 text-center",children:"Qty"}),(0,a.jsx)("th",{className:"p-3 w-24 text-right",children:"Price"}),(0,a.jsx)("th",{className:"p-3 w-20 text-right",children:"Tax (%)"}),(0,a.jsx)("th",{className:"p-3 w-24 text-right",children:"Disc."}),(0,a.jsx)("th",{className:"p-3 w-24 text-right",children:"Total"}),(0,a.jsx)("th",{className:"p-3 w-10"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-gray-100",children:[x.map((e,t)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"p-2",children:(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("select",{className:"w-full p-1.5 border border-gray-200 rounded text-sm mb-1",onChange:t=>N(e.id,t.target.value),value:"",children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"Select Product..."}),l.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," - ₹",e.price]},e.id))]}),(0,a.jsx)("input",{type:"text",placeholder:"Description",className:"w-full p-1.5 border border-gray-200 rounded text-sm",value:e.description,onChange:t=>w(e.id,"description",t.target.value)})]})}),(0,a.jsx)("td",{className:"p-2",children:(0,a.jsx)("input",{type:"number",min:"1",className:"w-full p-1.5 border border-gray-200 rounded text-center",value:e.quantity,onChange:t=>w(e.id,"quantity",parseFloat(t.target.value))})}),(0,a.jsx)("td",{className:"p-2",children:(0,a.jsx)("input",{type:"number",min:"0",step:"0.01",className:"w-full p-1.5 border border-gray-200 rounded text-right",value:e.unitPrice,onChange:t=>w(e.id,"unitPrice",parseFloat(t.target.value))})}),(0,a.jsx)("td",{className:"p-2",children:(0,a.jsx)("input",{type:"number",min:"0",max:"100",className:"w-full p-1.5 border border-gray-200 rounded text-right",value:e.taxRate,onChange:t=>w(e.id,"taxRate",parseFloat(t.target.value))})}),(0,a.jsx)("td",{className:"p-2",children:(0,a.jsx)("input",{type:"number",min:"0",step:"0.01",className:"w-full p-1.5 border border-gray-200 rounded text-right",value:e.discount,onChange:t=>w(e.id,"discount",parseFloat(t.target.value))})}),(0,a.jsxs)("td",{className:"p-3 text-right font-medium text-gray-900",children:["₹",e.total.toFixed(2)]}),(0,a.jsx)("td",{className:"p-2 text-center",children:(0,a.jsx)("button",{type:"button",onClick:()=>j(e.id),className:"text-red-400 hover:text-red-500 p-1 rounded-full hover:bg-red-50 transition-colors",children:(0,a.jsx)(f.A,{className:"w-4 h-4"})})})]},e.id)),0===x.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"p-8 text-center text-gray-400 text-sm",children:'No items added. Click "Add Item" to start.'})})]})]})})]}),(0,a.jsx)("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:(0,a.jsxs)("div",{className:"w-64 space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,a.jsx)("span",{children:"Subtotal"}),(0,a.jsxs)("span",{children:["₹",A.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,a.jsx)("span",{children:"Discount"}),(0,a.jsxs)("span",{children:["-₹",C.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,a.jsx)("span",{children:"Tax"}),(0,a.jsxs)("span",{children:["+₹",P.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-lg font-bold text-gray-900 pt-2 border-t border-gray-200",children:[(0,a.jsx)("span",{children:"Grand Total"}),(0,a.jsxs)("span",{children:["₹",T.toFixed(2)]})]})]})}),(0,a.jsxs)("div",{className:"pt-6 border-t border-gray-100 flex justify-end gap-3 sticky bottom-0 bg-white z-10",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-5 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-xl hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:d,className:"px-5 py-2.5 text-white bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl hover:shadow-lg hover:scale-[1.02] active:scale-95 transition-all font-medium flex items-center gap-2",children:d?"Saving...":(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.A,{className:"w-4 h-4"})," Save Invoice"]})})]})]})]})}):null}var C=s(25902);function P(){let{invoices:e,loading:t,fetchInvoices:s}=S(),[p,h]=(0,r.useState)(""),[g,f]=(0,r.useState)("all"),[v,y]=(0,r.useState)(null),[j,N]=(0,r.useState)(!1),[D,k]=(0,r.useState)(!1),P=e=>{switch(e){case"paid":return"bg-green-100 text-green-800 border-green-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"sent":return"bg-blue-100 text-blue-800 border-blue-200";case"overdue":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},T=e=>{switch(e){case"paid":return(0,a.jsx)(i.A,{className:"h-4 w-4"});case"pending":return(0,a.jsx)(n.A,{className:"h-4 w-4"});case"overdue":return(0,a.jsx)(l.A,{className:"h-4 w-4"});default:return(0,a.jsx)(o.A,{className:"h-4 w-4"})}},F=e.filter(e=>{let t=e.invoiceNumber?.toLowerCase().includes(p.toLowerCase())||e.customerName?.toLowerCase().includes(p.toLowerCase()),s="all"===g||e.status===g;return t&&s}),E={total:e.length,paid:e.filter(e=>"paid"===e.status).length,sent:e.filter(e=>"sent"===e.status).length,draft:e.filter(e=>"draft"===e.status).length,overdue:e.filter(e=>"overdue"===e.status).length,totalRevenue:e.filter(e=>"paid"===e.status).reduce((e,t)=>e+(t.grandTotal||0),0)},I=e=>{let t=new b.default;t.setFontSize(20),t.setTextColor(40,40,40),t.text("Adavakkad Collections",14,22),t.setFontSize(10),t.setTextColor(100,100,100),t.text("123 Main Street, City",14,28),t.text("Phone: +91 1234567890",14,33),t.text("Email: info@adavakkad.com",14,38),t.setFontSize(16),t.setTextColor(79,70,229),t.text("INVOICE",140,22),t.setFontSize(10),t.setTextColor(0,0,0),t.text(`Invoice #: ${e.invoiceNumber}`,140,28),t.text(`Date: ${new Date(e.issueDate).toLocaleDateString()}`,140,33),t.text(`Status: ${e.status.toUpperCase()}`,140,38),t.text("Bill To:",14,50),t.setFontSize(11),t.text(e.customerName,14,56);let s=e.items?.map(e=>[e.description,e.quantity,`₹${e.unitPrice}`,`₹${e.total}`])||[];w()(t,{startY:65,head:[["Item","Quantity","Price","Total"]],body:s,theme:"grid",headStyles:{fillColor:[79,70,229]},styles:{fontSize:10,cellPadding:3}});let a=t.lastAutoTable.finalY+10;t.setFontSize(10),t.text("Subtotal:",140,a),t.text(`₹${(e.grandTotal||0).toFixed(2)}`,170,a,{align:"right"}),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Grand Total:",140,a+7),t.text(`₹${(e.grandTotal||0).toFixed(2)}`,170,a+7,{align:"right"}),t.setFontSize(8),t.setFont("helvetica","normal"),t.setTextColor(150,150,150),t.text("Thank you for your business!",105,280,{align:"center"}),t.save(`Invoice_${e.invoiceNumber}.pdf`)};return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2 flex items-center gap-3",children:[(0,a.jsx)(o.A,{className:"h-10 w-10 text-indigo-600"}),"E-Invoicing"]}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage and track your invoices"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6 text-white",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-white/80 text-sm font-medium",children:"Total Invoices"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:E.total})]}),(0,a.jsx)(o.A,{className:"h-12 w-12 text-white/30"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Paid"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-600",children:E.paid})]}),(0,a.jsx)(i.A,{className:"h-12 w-12 text-green-300"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Sent"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:E.sent})]}),(0,a.jsx)(d.A,{className:"h-12 w-12 text-blue-300"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Draft"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-yellow-600",children:E.draft})]}),(0,a.jsx)(o.A,{className:"h-12 w-12 text-yellow-300"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Overdue"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-red-600",children:E.overdue})]}),(0,a.jsx)(l.A,{className:"h-12 w-12 text-red-300"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Total Revenue"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-indigo-600",children:["₹",E.totalRevenue.toFixed(2)]})]}),(0,a.jsx)(o.A,{className:"h-12 w-12 text-indigo-300"})]})})]}),(0,a.jsx)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(c.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),(0,a.jsx)("input",{type:"text",placeholder:"Search invoices...",value:p,onChange:e=>h(e.target.value),className:"pl-10 pr-4 py-3 border border-gray-300 rounded-xl w-full focus:ring-2 focus:ring-indigo-600 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("select",{value:g,onChange:e=>f(e.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-600",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"draft",children:"Draft"}),(0,a.jsx)("option",{value:"sent",children:"Sent"}),(0,a.jsx)("option",{value:"paid",children:"Paid"}),(0,a.jsx)("option",{value:"overdue",children:"Overdue"}),(0,a.jsx)("option",{value:"cancelled",children:"Cancelled"})]}),(0,a.jsxs)("button",{onClick:()=>k(!0),className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-3 rounded-xl flex items-center gap-2 hover:scale-105 transition-all shadow-lg",children:[(0,a.jsx)(u.A,{className:"h-5 w-5"}),"New Invoice"]})]})]})}),t?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("div",{className:"text-gray-600",children:"Loading invoices..."})}):(0,a.jsx)("div",{className:"bg-white shadow-lg rounded-2xl overflow-hidden border border-gray-100",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gradient-to-r from-indigo-600/10 to-purple-600/10",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice #"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-indigo-50 transition-colors",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.invoiceNumber})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.customerName})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-600",children:new Date(e.issueDate).toLocaleDateString()})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"text-sm font-bold text-gray-900",children:["₹",e.grandTotal?.toFixed(2)]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("span",{className:`px-3 py-1 inline-flex items-center gap-1 text-xs font-semibold rounded-full border ${P(e.status)}`,children:[T(e.status),e.status.charAt(0).toUpperCase()+e.status.slice(1)]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>{y(e),N(!0)},className:"text-indigo-600 hover:text-indigo-700 p-2 hover:bg-indigo-50 rounded-lg transition-colors",children:(0,a.jsx)(x.A,{className:"h-4 w-4"})}),(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-700 p-2 hover:bg-blue-50 rounded-lg transition-colors",children:(0,a.jsx)(d.A,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>I(e),title:"Download PDF",className:"text-green-600 hover:text-green-700 p-2 hover:bg-green-50 rounded-lg transition-colors",children:(0,a.jsx)(m.A,{className:"h-4 w-4"})})]})})]},e.id))})]})})}),(0,a.jsx)(C.a,{isOpen:j,onClose:()=>N(!1),title:"Invoice Details",size:"large",children:v&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Invoice Number"}),(0,a.jsx)("p",{className:"text-lg font-bold",children:v.invoiceNumber})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Date"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:new Date(v.issueDate).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Customer"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:v.customerName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Status"}),(0,a.jsxs)("span",{className:`px-3 py-1 inline-flex items-center gap-1 text-xs font-semibold rounded-full border ${P(v.status)}`,children:[T(v.status),v.status.charAt(0).toUpperCase()+v.status.slice(1)]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"Items"}),(0,a.jsx)("div",{className:"space-y-2",children:v.items?.map((e,t)=>a.jsxs("div",{className:"flex justify-between bg-gray-50 p-3 rounded-lg",children:[a.jsx("span",{children:e.description}),a.jsxs("span",{className:"font-semibold",children:["₹",e.total?.toFixed(2)]})]},t))})]}),(0,a.jsx)("div",{className:"border-t pt-4",children:(0,a.jsxs)("div",{className:"flex justify-between text-lg font-bold",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsxs)("span",{className:"text-indigo-600",children:["₹",v.grandTotal?.toFixed(2)]})]})})]})}),(0,a.jsx)(A,{isOpen:D,onClose:()=>k(!1)})]})}},54810:(e,t,s)=>{"use strict";s.d(t,{b:()=>a});let a=(0,s(80159).vt)(e=>({members:[],loading:!1,error:null,fetchMembers:async()=>{e({loading:!0,error:null});try{let t=await fetch("/api/members");if(!t.ok)throw Error("Failed to fetch members");let s=(await t.json()).map(e=>({...e,joinDate:new Date(e.joinDate).toISOString().split("T")[0]}));e({members:s})}catch(t){e({error:t.message})}finally{e({loading:!1})}},addMember:async t=>{e({loading:!0,error:null});try{let s=await fetch("/api/members",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw Error("Failed to create member");let a=await s.json(),r={...a,joinDate:new Date(a.joinDate).toISOString().split("T")[0]};return e(e=>({members:[...e.members,r]})),r}catch(t){throw e({error:t.message}),t}finally{e({loading:!1})}},updateMember:async(t,s)=>{e({loading:!0,error:null});try{let a=await fetch(`/api/members/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw Error("Failed to update member");let r=await a.json(),i={...r,joinDate:new Date(r.joinDate).toISOString().split("T")[0]};e(e=>({members:e.members.map(e=>e.id===t?i:e)}))}catch(t){throw e({error:t.message}),t}finally{e({loading:!1})}},deleteMember:async t=>{e({loading:!0,error:null});try{if(!(await fetch(`/api/members/${t}`,{method:"DELETE"})).ok)throw Error("Failed to delete member");e(e=>({members:e.members.filter(e=>e.id!==t)}))}catch(t){throw e({error:t.message}),t}finally{e({loading:!1})}}}))},20429:(e,t,s)=>{"use strict";s.d(t,{K:()=>a});let a=(0,s(80159).vt)(e=>({products:[],loading:!1,error:null,fetchProducts:async()=>{e({loading:!0,error:null});try{let t=await fetch("/api/products");if(!t.ok)throw Error("Failed to fetch products");let s=(await t.json()).map(e=>({...e,image_url:e.imageUrl||e.image_url,cost_price:e.costPrice||e.cost_price,profit_margin:e.profitMargin||e.profit_margin,is_featured:e.isFeatured,is_available:e.isAvailable}));e({products:s})}catch(t){e({error:t.message})}finally{e({loading:!1})}},addProduct:async t=>{e({loading:!0,error:null});try{let s=await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw Error("Failed to create product");let r=await s.json(),i={...r,image_url:r.imageUrl,cost_price:r.costPrice,profit_margin:r.profitMargin,is_featured:r.isFeatured,is_available:r.isAvailable};e(e=>({products:[i,...e.products]})),await a.getState().fetchProducts()}catch(t){e({error:t.message})}finally{e({loading:!1})}},updateProduct:async(t,s)=>{e({loading:!0,error:null});try{let a=await fetch(`/api/products/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw Error("Failed to update product");let r=await a.json(),i={...r,image_url:r.imageUrl,cost_price:r.costPrice,profit_margin:r.profitMargin,is_featured:r.isFeatured,is_available:r.isAvailable};e(e=>({products:e.products.map(e=>e.id===t?i:e)}))}catch(t){e({error:t.message})}finally{e({loading:!1})}},deleteProduct:async t=>{e({loading:!0,error:null});try{if(!(await fetch(`/api/products/${t}`,{method:"DELETE"})).ok)throw Error("Failed to delete product");e(e=>({products:e.products.filter(e=>e.id!==t)}))}catch(t){e({error:t.message})}finally{e({loading:!1})}}}))},31140:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/rakzzm/Documents/Applications/Advakkad POS Application/src/app/(dashboard)/invoices/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/rakzzm/Documents/Applications/Advakkad POS Application/src/app/(dashboard)/invoices/page.tsx","default")},80159:(e,t,s)=>{"use strict";s.d(t,{vt:()=>x});let a=e=>{let t;let s=new Set,a=(e,a)=>{let r="function"==typeof e?e(t):e;if(!Object.is(r,t)){let e=t;t=(null!=a?a:"object"!=typeof r||null===r)?r:Object.assign({},t,r),s.forEach(s=>s(t,e))}},r=()=>t,i={setState:a,getState:r,getInitialState:()=>n,subscribe:e=>(s.add(e),()=>s.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},n=t=e(a,r,i);return i},r=e=>e?a(e):a;var i=s(58009),n=s(73450);let{useDebugValue:l}=i,{useSyncExternalStoreWithSelector:o}=n,d=!1,c=e=>e,u=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?r(e):e,s=(e,s)=>(function(e,t=c,s){s&&!d&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),d=!0);let a=o(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return l(a),a})(t,e,s);return Object.assign(s,t),s},x=e=>e?u(e):u}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[638,4815,8077,2628,2366,9046,1811],()=>s(24154));module.exports=a})();