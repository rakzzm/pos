(()=>{var e={};e.id=1519,e.ids=[1519],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},17630:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>f,routeModule:()=>d,serverHooks:()=>w,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>x});var a={};r.r(a),r.d(a,{GET:()=>p,POST:()=>c});var n=r(42706),s=r(28203),o=r(45994),i=r(39187);let u=new(r(96330)).PrismaClient;async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("staffId"),a=t.get("date"),n=t.get("month"),s={};if(r&&(s.staffId=r),a){let e=new Date(a),t=new Date(a);t.setDate(t.getDate()+1),s.date={gte:e,lt:t}}if(n){let[e,t]=n.split("-"),r=new Date(parseInt(e),parseInt(t)-1,1),a=new Date(parseInt(e),parseInt(t),0);s.date={gte:r,lte:a}}let o=await u.attendance.findMany({where:s,include:{staff:{select:{name:!0,employeeId:!0}}},orderBy:{date:"desc"}});return i.NextResponse.json(o)}catch(e){return i.NextResponse.json({error:"Failed to fetch attendance"},{status:500})}}async function c(e){try{let t=await e.json(),{action:r,staffId:a,time:n,date:s,notes:o}=t;if("clock-in"===r){let e=new Date;if(e.setHours(0,0,0,0),await u.attendance.findFirst({where:{staffId:a,date:{gte:e},punchOut:null}}))return i.NextResponse.json({error:"Already clocked in"},{status:400});let t=await u.attendance.create({data:{staffId:a,date:new Date,punchIn:n,status:"present",totalHours:0}});return i.NextResponse.json(t)}if("manual"===r){let e=await u.attendance.create({data:{staffId:a,date:new Date(s),punchIn:t.punchIn,punchOut:t.punchOut,totalHours:t.totalHours||0,status:t.status||"present",notes:o}});return i.NextResponse.json(e)}return i.NextResponse.json({error:"Invalid action"},{status:400})}catch(e){return console.error(e),i.NextResponse.json({error:"Failed to create attendance"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/attendance/route",pathname:"/api/attendance",filename:"route",bundlePath:"app/api/attendance/route"},resolvedPagePath:"/Users/rakzzm/Documents/Applications/Advakkad POS Application/src/app/api/attendance/route.ts",nextConfigOutput:"standalone",userland:a}),{workAsyncStorage:l,workUnitAsyncStorage:x,serverHooks:w}=d;function f(){return(0,o.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:x})}},96487:()=>{},78335:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,5452],()=>r(17630));module.exports=a})();