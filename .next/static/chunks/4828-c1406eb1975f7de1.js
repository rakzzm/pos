"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4828],{37788:(e,t,r)=>{r.d(t,{b:()=>a});let a=(0,r(83749).vt)(e=>({members:[],loading:!1,error:null,fetchMembers:async()=>{e({loading:!0,error:null});try{let t=await fetch("/api/members");if(!t.ok)throw Error("Failed to fetch members");let r=(await t.json()).map(e=>({...e,joinDate:new Date(e.joinDate).toISOString().split("T")[0]}));e({members:r})}catch(t){e({error:t.message})}finally{e({loading:!1})}},addMember:async t=>{e({loading:!0,error:null});try{let r=await fetch("/api/members",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw Error("Failed to create member");let a=await r.json(),o={...a,joinDate:new Date(a.joinDate).toISOString().split("T")[0]};return e(e=>({members:[...e.members,o]})),o}catch(t){throw e({error:t.message}),t}finally{e({loading:!1})}},updateMember:async(t,r)=>{e({loading:!0,error:null});try{let a=await fetch("/api/members/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw Error("Failed to update member");let o=await a.json(),i={...o,joinDate:new Date(o.joinDate).toISOString().split("T")[0]};e(e=>({members:e.members.map(e=>e.id===t?i:e)}))}catch(t){throw e({error:t.message}),t}finally{e({loading:!1})}},deleteMember:async t=>{e({loading:!0,error:null});try{if(!(await fetch("/api/members/".concat(t),{method:"DELETE"})).ok)throw Error("Failed to delete member");e(e=>({members:e.members.filter(e=>e.id!==t)}))}catch(t){throw e({error:t.message}),t}finally{e({loading:!1})}}}))},8464:(e,t,r)=>{r.d(t,{x:()=>i});var a=r(83749),o=r(37788);let i=(0,a.vt)((e,t)=>({orders:[],loading:!1,error:null,fetchOrders:async()=>{e({loading:!0,error:null});try{let t=await fetch("/api/orders");if(!t.ok)throw Error("Failed to fetch orders");let r=(await t.json()).map(e=>({...e,itemCount:e.items.reduce((e,t)=>e+t.quantity,0),date:new Date(e.date).toLocaleString()}));e({orders:r})}catch(t){e({error:t.message})}finally{e({loading:!1})}},addOrder:async t=>{e({loading:!0,error:null});try{let r={...t,orderNumber:"ORD-".concat(Date.now())},a=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw Error("Failed to create order");let o=await a.json(),i={...o,itemCount:o.items.reduce((e,t)=>e+t.quantity,0),date:new Date(o.date).toLocaleString()};e(e=>({orders:[i,...e.orders]})),"completed"===i.status&&i.memberId&&await l(i.memberId,i.total)}catch(t){throw e({error:t.message}),t}finally{e({loading:!1})}},updateOrder:async(r,a)=>{e({loading:!0,error:null});try{let o=await fetch("/api/orders/".concat(r),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok)throw Error("Failed to update order");let i=await o.json(),n={...i,itemCount:i.items.reduce((e,t)=>e+t.quantity,0),date:new Date(i.date).toLocaleString()},d=t().orders.find(e=>e.id===r);e(e=>({orders:e.orders.map(e=>e.id===r?n:e)})),"completed"===a.status&&(null==d?void 0:d.status)!=="completed"&&n.memberId&&await l(n.memberId,n.total)}catch(t){throw e({error:t.message}),t}finally{e({loading:!1})}},updateOrderStatus:async(r,a)=>{e({loading:!0,error:null});try{let o=await fetch("/api/orders/".concat(r),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a})});if(!o.ok)throw Error("Failed to update order status");let i=await o.json(),n={...i,itemCount:i.items.reduce((e,t)=>e+t.quantity,0),date:new Date(i.date).toLocaleString()},d=t().orders.find(e=>e.id===r);e(e=>({orders:e.orders.map(e=>e.id===r?n:e)})),"completed"===a&&n.memberId&&(null==d?void 0:d.status)!=="completed"&&await l(n.memberId,n.total)}catch(t){e({error:t.message})}finally{e({loading:!1})}},deleteOrder:async t=>{e({loading:!0,error:null});try{if(!(await fetch("/api/orders/".concat(t),{method:"DELETE"})).ok)throw Error("Failed to delete order");e(e=>({orders:e.orders.filter(e=>e.id!==t)}))}catch(t){e({error:t.message})}finally{e({loading:!1})}}}));async function l(e,t){let r=o.b.getState(),a=r.members.find(t=>t.memberId===e);if(a){let e=1*Math.floor(t/100);await r.updateMember(a.id,{points:a.points+e,totalSpent:a.totalSpent+t})}}},73453:(e,t,r)=>{r.d(t,{K:()=>a});let a=(0,r(83749).vt)(e=>({products:[],loading:!1,error:null,fetchProducts:async()=>{e({loading:!0,error:null});try{let t=await fetch("/api/products");if(!t.ok)throw Error("Failed to fetch products");let r=(await t.json()).map(e=>({...e,image_url:e.imageUrl||e.image_url,cost_price:e.costPrice||e.cost_price,profit_margin:e.profitMargin||e.profit_margin,is_featured:e.isFeatured,is_available:e.isAvailable}));e({products:r})}catch(t){e({error:t.message})}finally{e({loading:!1})}},addProduct:async t=>{e({loading:!0,error:null});try{let r=await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw Error("Failed to create product");let o=await r.json(),i={...o,image_url:o.imageUrl,cost_price:o.costPrice,profit_margin:o.profitMargin,is_featured:o.isFeatured,is_available:o.isAvailable};e(e=>({products:[i,...e.products]})),await a.getState().fetchProducts()}catch(t){e({error:t.message})}finally{e({loading:!1})}},updateProduct:async(t,r)=>{e({loading:!0,error:null});try{let a=await fetch("/api/products/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw Error("Failed to update product");let o=await a.json(),i={...o,image_url:o.imageUrl,cost_price:o.costPrice,profit_margin:o.profitMargin,is_featured:o.isFeatured,is_available:o.isAvailable};e(e=>({products:e.products.map(e=>e.id===t?i:e)}))}catch(t){e({error:t.message})}finally{e({loading:!1})}},deleteProduct:async t=>{e({loading:!0,error:null});try{if(!(await fetch("/api/products/".concat(t),{method:"DELETE"})).ok)throw Error("Failed to delete product");e(e=>({products:e.products.filter(e=>e.id!==t)}))}catch(t){e({error:t.message})}finally{e({loading:!1})}}}))},87e3:(e,t,r)=>{r.d(t,{X:()=>i});var a=r(83749),o=r(8464);let i=(0,a.vt)(e=>({summary:null,loading:!1,error:null,calculateSummary:t=>{e({loading:!0,error:null});try{let r;let a=o.x.getState().orders,i=new Date,l=new Date(i.getFullYear(),i.getMonth(),i.getDate());switch(t){case"today":r=l;break;case"yesterday":(r=new Date(l)).setDate(r.getDate()-1);break;case"week":(r=new Date(l)).setDate(r.getDate()-7);break;case"month":(r=new Date(l)).setMonth(r.getMonth()-1)}let n=a.filter(e=>{let t=new Date(e.date);return t>=r&&t<=i}),d=n.filter(e=>"completed"===e.status),s=n.filter(e=>"pending"===e.status),c=n.filter(e=>"cancelled"===e.status),m=d.reduce((e,t)=>e+t.total,0),u=d.reduce((e,t)=>e+t.items.reduce((e,t)=>e+t.quantity,0),0),g=new Set(d.map(e=>e.customerName)).size,p={grossAmount:m,netSales:.9*m,discounts:.05*m,tax:.1*m,charges:.02*m,roundingAmount:.1*Math.random(),netTotal:.97*m,totalOutlets:3,dailyAverageSales:m/("today"===t?1:"yesterday"===t?1:"week"===t?7:30),quantity:u,transactionCount:d.length,voidedTransactions:Math.floor(.02*d.length),voidedTransferCount:Math.floor(.01*d.length),cancelledTransactionCount:c.length,averageValue:d.length?m/d.length:0,averageUnit:d.length?u/d.length:0,customerAverageValue:g?m/g:0,openOrderQuantity:s.length,openOrderAmount:s.reduce((e,t)=>e+t.total,0)};e({summary:p})}catch(t){e({error:t.message})}finally{e({loading:!1})}}}))}}]);